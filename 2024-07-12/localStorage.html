<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Local Storage</title>
  </head>
  <body>
    <div id="container">
      <h1>&lang; 할 일 목록 &rang;</h1>
      <p>해야할 일들을 기록하기</p>
      <form>
        <input type="text" id="item" autofocus />
        <button id="add" class="addBtn">추가하기</button>
      </form>
      <!-- 표시할 영역 -->
      <div id="itemList"></div>
    </div>

    <script>
      let itemList = [];
      let btn = document.querySelector("#add");
      btn.addEventListener("click", addList);
      getItems();
      function addList() {
        event.preventDefault();
        let item = document.getElementById("item").value;
        console.log(item);
        if (item != null) {
          //itemList.push(item); //배열의 맨 뒤에 추가
          itemList.unshift(item); //배열의 맨 앞에 추가
          document.querySelector("#item").value = "";
          document.querySelector("#item").focus();
        }
        localStorage.setItem("storageList", JSON.stringify(itemList));
        showList();
      }
      function showList() {
        let list = "<ul>"; //목록 시작 <ul>태그 저장
        for (let i = 0; i < itemList.length; i++) {
          //배열 요소마다 반복
          list +=
            "<li>" +
            itemList[i] +
            "<span class='close' id=" +
            i +
            "> X</span></li>";
        }
        list += "</ul>";
        document.querySelector("#itemList").innerHTML = list;

        //삭제 버튼 추가
        let remove = document.querySelectorAll(".close");
        for (let i = 0; i < remove.length; i++) {
          remove[i].addEventListener("click", removeList); //removeList함수 실행
        }
      }

      function getItems() {
        let storedData = localStorage.getItem("storageList");
        if (storedData != null) itemList = JSON.parse(storedData);
        showList();
      }

      function removeList() {
        let id = this.getAttribute("id"); //클릭 id값을 반환
        itemList.splice(id, 1); //itemList배열에서 인덱스 값이 id인 요소 1개 삭제
        showList(); //변경된 리스트 화면 표시
        localStorage.setItem("storageList", JSON.stringify(itemList));
      }

      let array = [1, 2, 3];
      localStorage.setItem("name", JSON.stringify(array));

      let todo = localStorage.getItem("name");
      JSOn.parse(todo);
      //localStorage.setItem("key","value") key값으로 value를 저장
      //localStorage.getItem("key") key값인 value를 가져옴
      //locatStorage.clear() 로컬스토리지 정리

      //여러 값으로 된 문자열을 가져와 배열 형태로 변환할 때는 JSON.parse() 메서드를 사용
      //JSON(JavaScript Object Notation)은 자료를 주고받는 방식을 가리키는 말
    </script>
  </body>
</html>
